/* DW-OLAP-SQL.TXT                                    	*/
/* DATA WAREHOUSE OLAP SQL 				*/

/* ROLLUP EXAMPLE Figure 13.21 */
SELECT   V.V_CODE, P.P_CODE, 
SUM(SALE_UNITS*SALE_PRICE) AS TOTSALES
FROM     DWDAYSALESFACT AS S INNER JOIN DWPRODUCT AS P 
ON S.P_CODE = P.P_CODE
INNER JOIN DWVENDOR AS V ON P.V_CODE = V.V_CODE
GROUP BY ROLLUP (V.V_CODE, P.P_CODE)
ORDER BY V.V_CODE, P.P_CODE;


/* CUBE EXAMPLE Figure 13.22 */
SELECT   TM_MONTH, P.P_CODE, 
SUM(SALE_UNITS*SALE_PRICE) AS TOTSALES
FROM     DWDAYSALESFACT AS S INNER JOIN DWPRODUCT AS P
ON S.P_CODE = P.P_CODE
INNER JOIN DWTIME AS T 
ON S.TM_ID = T.TM_ID
GROUP BY CUBE (TM_MONTH, P.P_CODE)
ORDER BY TM_MONTH, P.P_CODE;
