-- Virtual Tables: Creataing a View (p.346, Chapter 8)

CREATE VIEW PRODUCT_3 AS
SELECT P_DESCRIPT, P_QOH, P_PRICE 
FROM PRODUCT
WHERE P_PRICE > (50.00);

SELECT * FROM PRODUCT_3;

CREATE VIEW PROD_TO_ORDER AS
SELECT P_CODE, P_DESCRIPT, P_QOH, P_PRICE 
FROM PRODUCT
WHERE P_QOH < (P_MIN + 10);

SELECT * FROM PROD_TO_ORDER;

CREATE VIEW SUMPRDXVEN AS
SELECT V_CODE, 
	SUM(P_QOH * P_PRICE) AS TOTCOST,
        MAX(P_QOH) AS MAXQTY,
        MIN(P_QOH) AS MINQTY,
        AVG(P_QOH) AS AVGQTY
FROM   PRODUCT
GROUP  BY V_CODE;

SELECT * FROM SUMPRDXVEN;


-- Joining Database Tables (p.275)

SELECT P_DESCRIPT, P_PRICE, VENDOR.V_CODE, V_NAME, V_CONTACT, V_AREACODE, V_PHONE 
FROM   PRODUCT, VENDOR
WHERE  PRODUCT.V_CODE = VENDOR.V_CODE;

SELECT P_DESCRIPT, P_PRICE, VENDOR.V_CODE, V_NAME, V_CONTACT, V_AREACODE, V_PHONE
FROM   PRODUCT, VENDOR
WHERE  PRODUCT.V_CODE = VENDOR.V_CODE
ORDER  BY P_PRICE;

SELECT P_DESCRIPT, P_PRICE, V_NAME, V_CONTACT, V_AREACODE, V_PHONE
FROM   PRODUCT, VENDOR
WHERE  PRODUCT.V_CODE = VENDOR.V_CODE
  AND  P_INDATE > '2012-01-15';

SELECT CUS_LNAME, INVOICE.INV_NUMBER, INV_DATE, P_DESCRIPT
FROM   CUSTOMER, INVOICE, LINE, PRODUCT
WHERE  CUSTOMER.CUS_CODE = INVOICE.CUS_CODE
  AND  INVOICE.INV_NUMBER = LINE.INV_NUMBER
  AND  LINE.P_CODE = PRODUCT.P_CODE
  AND  CUSTOMER.CUS_CODE = 10014
ORDER  BY INVOICE.INV_NUMBER;

SELECT P_DESCRIPT, P_PRICE, V_NAME, V_CONTACT, V_AREACODE, V_PHONE
FROM   PRODUCT P, VENDOR V
WHERE  P.V_CODE = V.V_CODE
ORDER  BY P_PRICE;

