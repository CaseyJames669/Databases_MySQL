-- SQL Indexes (p.241)

CREATE INDEX P_INDATEX ON PRODUCT(P_INDATE);

CREATE INDEX VENPRODX ON PRODUCT(V_CODE,P_CODE);

CREATE INDEX PROD_PRICEX ON PRODUCT(P_PRICE DESC);

DROP INDEX PROD_PRICEX ON PRODUCT;


-- Listing Table Rows (p.244)

SELECT * FROM PRODUCT;

SELECT P_CODE, P_DESCRIPT, P_INDATE, P_QOH, P_MIN, P_PRICE, P_DISCOUNT, V_CODE
FROM   PRODUCT;


-- Updating Table Rows (p.246)

UPDATE PRODUCT
SET    P_INDATE = '2012-01-18'
WHERE  P_CODE = '13-Q2/P2';

UPDATE PRODUCT
SET    P_INDATE = '2012-01-18', 
       P_PRICE = 17.99, 
       P_MIN = 10
WHERE  P_CODE = '13-Q2/P2';

SELECT * FROM PRODUCT;


-- Deleting Table Rows (p.247)

DELETE FROM PRODUCT
WHERE  P_CODE = '13-Q2/P2';


-- Selecting Rows with Conditional Restrictions (p.248)

SELECT P_DESCRIPT, P_INDATE, P_PRICE, V_CODE
FROM   PRODUCT
WHERE  V_CODE = 21344;

SELECT P_DESCRIPT, P_INDATE, P_PRICE, V_CODE
FROM   PRODUCT
WHERE  V_CODE <> 21344;

SELECT P_DESCRIPT, P_QOH, P_MIN, P_PRICE
FROM   PRODUCT
WHERE  P_PRICE <= 10;

SELECT P_CODE, P_DESCRIPT, P_QOH, P_MIN, P_PRICE
FROM   PRODUCT
WHERE  P_CODE < '1558-QW1';

SELECT P_DESCRIPT, P_QOH, P_MIN, P_PRICE, P_INDATE
FROM   PRODUCT
WHERE  P_INDATE >= '2012-01-20';

SELECT P_DESCRIPT, P_QOH, P_PRICE, P_QOH * P_PRICE
FROM   PRODUCT;

SELECT P_DESCRIPT, P_QOH, P_PRICE, P_QOH * P_PRICE AS TOTVALUE
FROM   PRODUCT;

	
-- Logical Operators AND, OR, NOT (p.253)

SELECT P_DESCRIPT, P_INDATE, P_PRICE, V_CODE
FROM   PRODUCT
WHERE  V_CODE = 21344
   OR  V_CODE = 24288;

SELECT P_DESCRIPT, P_INDATE, P_PRICE, V_CODE
FROM   PRODUCT
WHERE  P_PRICE < 50
AND    P_INDATE > '2012-01-15';

SELECT P_DESCRIPT, P_INDATE, P_PRICE, V_CODE
FROM   PRODUCT
WHERE (P_PRICE < 50 AND P_INDATE > '2012-01-15')
OR     V_CODE = 24288;

SELECT *
FROM   PRODUCT
WHERE  NOT (V_CODE = 21344);


-- Special Operators : BETWEEN, IS NULL, LIKE, IN, EXITS (p.255)

SELECT *
FROM   PRODUCT
WHERE  P_PRICE BETWEEN 50.00 AND 100.00;

SELECT P_CODE, P_DESCRIPT
FROM   PRODUCT
WHERE  V_CODE IS NULL;

SELECT V_NAME, V_CONTACT, V_AREACODE, V_PHONE
FROM   VENDOR
WHERE  V_CONTACT LIKE 'Smith%';

-- or use this version if case sensitive 

SELECT V_NAME, V_CONTACT, V_AREACODE, V_PHONE
FROM   VENDOR
WHERE  UPPER(V_CONTACT) LIKE 'SMITH%';

SELECT *
FROM   PRODUCT
WHERE  V_CODE IN (21344, 24288);

SELECT *
FROM   VENDOR
WHERE  EXISTS (SELECT * FROM PRODUCT WHERE P_QOH <= P_MIN);

SELECT * FROM VENDOR
WHERE  EXISTS (SELECT * FROM PRODUCT WHERE P_QOH < P_MIN * 2);

SELECT DISTINCT V_CODE FROM PRODUCT;      	


-- Additional Data Definition Commands (p.259)								

ALTER TABLE PRODUCT
MODIFY COLUMN V_CODE VARCHAR(5);

ALTER  TABLE PRODUCT
MODIFY COLUMN P_PRICE DECIMAL(9,2);

ALTER TABLE PRODUCT
ADD   P_SALECODE CHAR(1);

UPDATE PRODUCT
SET    P_SALECODE = '2'
WHERE  P_CODE = '1546-QQ2';

UPDATE PRODUCT
SET    P_SALECODE = '1'
WHERE  P_CODE IN ('2232/QWE', '2232/QTY');

UPDATE PRODUCT
SET    P_SALECODE = '2'
WHERE  P_INDATE < '2012-12-25';

UPDATE PRODUCT
SET    P_SALECODE = '1'
WHERE  P_INDATE >= '2012-01-16'
AND    P_INDATE <  '2012-02-10';

UPDATE PRODUCT
SET    P_QOH = P_QOH + 20
WHERE  P_CODE = '2232/QWE';

UPDATE PRODUCT
SET    P_PRICE = P_PRICE * 1.10
WHERE  P_PRICE < 50.00;

CREATE TABLE PART (
PART_CODE     CHAR(8) NOT NULL UNIQUE,
PART_DESCRIPT CHAR(35),
PART_PRICE    DECIMAL(8,2),
PRIMARY KEY (PART_CODE));

INSERT INTO PART (PART_CODE, PART_DESCRIPT, PART_PRICE)
SELECT P_CODE, P_DESCRIPT, P_PRICE FROM PRODUCT;

ALTER TABLE PART 
  ADD PRIMARY KEY(PART_CODE);

ALTER TABLE PRODUCT
  ADD PRIMARY KEY(P_CODE);

ALTER TABLE PRODUCT
  ADD FOREIGN KEY(V_CODE) REFERENCES VENDOR;

ALTER TABLE PRODUCT 
  ADD PRIMARY KEY(P_CODE),
  FOREIGN KEY (V_CODE) REFERENCES VENDOR;



